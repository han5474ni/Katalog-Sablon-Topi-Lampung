<!DOCTYPE html>
<html>
<head>
    <title>Analytics API Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Analytics API Test</h1>
    <div id="results"></div>

    <script>
        const resultsDiv = document.getElementById('results');
        
        async function testApi(endpoint, name) {
            const test = document.createElement('div');
            test.className = 'test';
            test.innerHTML = `<h3>${name}</h3><p>Testing...</p>`;
            resultsDiv.appendChild(test);
            
            try {
                const url = `/admin/api/analytics/${endpoint}?period=month`;
                console.log('Fetching:', url);
                
                const response = await fetch(url);
                const status = response.status;
                const contentType = response.headers.get('content-type');
                const text = await response.text();
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    data = null;
                }
                
                test.classList.add(status === 200 ? 'success' : 'error');
                test.innerHTML = `
                    <h3>${name}</h3>
                    <p><strong>Status:</strong> ${status}</p>
                    <p><strong>Content-Type:</strong> ${contentType}</p>
                    <p><strong>Response:</strong></p>
                    <pre>${data ? JSON.stringify(data, null, 2) : text.substring(0, 500)}</pre>
                `;
            } catch (error) {
                test.classList.add('error');
                test.innerHTML = `
                    <h3>${name}</h3>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        }

        // Test all endpoints
        console.log('Starting API tests...');
        testApi('sales-overview', 'Sales Overview');
        testApi('sales-trend', 'Sales Trend');
        testApi('order-status', 'Order Status');
        testApi('customer', 'Customer Analytics');
        testApi('conversion-funnel', 'Conversion Funnel');
    </script>
</body>
</html>
